CREATE DATABASE movie_db;

USE movie_db;

CREATE TABLE movies (
     id INT AUTO_INCREMENT PRIMARY KEY,
     name VARCHAR(255) NOT NULL,
     src VARCHAR(255),
     duration INT
 );

CREATE TABLE reservations (
     id INT AUTO_INCREMENT PRIMARY KEY,
     movie_id INT,
     user_name VARCHAR(255),
     reservation_date DATE,
     reservation_time TIME,
     seats TEXT,
     tickets INT,
     FOREIGN KEY (movie_id) REFERENCES movies(id)
 );

CREATE TABLE showtimes (
     id INT AUTO_INCREMENT PRIMARY KEY, -- 場次 ID
     movie_id INT NOT NULL,             -- 對應的電影 ID
     show_date DATE NOT NULL,           -- 放映日期
     show_time TIME NOT NULL,           -- 放映時間
     room VARCHAR(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci,    -- 放映廳（如 Room A, Room B）
    FOREIGN KEY (movie_id) REFERENCES movies(id)    -- 關聯電影表
);



INSERT INTO movies (name, src, duration) VALUES
('Avatar', 'image/IMG_5841.JPG', 162),
('Dune', 'image/IMG_5842.JPG', 155),
('To All the Boys I''ve Loved Before', 'image/IMG_5840.JPG', 99),
('Little Woman', 'image/IMG_5839.JPG', 135),
('Fresh', 'image/IMG_5838.JPG', 117),
('Before Sunrise', 'image/IMG_5836.JPG', 105),
('Everything Everywhere All at Once', 'image/IMG_5837.JPG', 140),
('Enola Holmes', 'image/IMG_5833.JPG', 123),
('Call Me By Your Name', 'image/IMG_5835.JPG', 130),
('Princess Mononoke', 'image/IMG_5834.JPG', 124);

-- 修正 cinemas 表結構
CREATE TABLE cinemas (
    id INT AUTO_INCREMENT PRIMARY KEY, -- 自動遞增主鍵
    name TEXT NOT NULL,
    address TEXT NOT NULL,
    Latitude DOUBLE NOT NULL,
    Longitude DOUBLE NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- 插入 cinemas 資料，移除重複記錄 (ID 42)
INSERT INTO cinemas (name, address, Latitude, Longitude) VALUES
('信義威秀影城', '台北市信義區松壽路16、18', 25.0356745, 121.5639672),
('誠品電影院', '台北市信義區煙廠路80號（誠品生活松煙店）地下2樓', 25.0444858, 121.5587811),
('京站威秀影城', '台北市大同區市民大道一段209號（京站時尚廣場）5至7樓', 25.0493128, 121.5146186),
('微風國賓影城', '台北市松山區復興南路一段39號（微風廣場）7至9樓', 25.0503198, 121.5343933),
('國賓大戲院', '108台北市萬華區成都路88號', 25.0429306, 121.5020237),
('今日秀泰影城', '108台北市萬華區峨眉街52號', 25.0436417, 121.5028475),
('環球國賓影城', '235新北市中和區中山路三段122號', 25.0071737, 121.4722309),
('板橋大遠百威秀影城', '220新北市板橋區新站路28號10樓', 25.0140777, 121.4645825),
('板橋秀泰影城', '220新北市板橋區縣民大道二段3號', 25.0123595, 121.4593852),
('昕境廣場國賓影城', '新北市林口區文化三路一段402巷2號四樓', 25.0737528, 121.3662621),
('美麗華台茂影城', '338桃園市蘆竹區南崁路一段112號', 25.0536651, 121.2859896),
('基隆秀泰影城', '基隆市中正區信一路177號', 25.1308823, 121.742127),
('威尼斯影城', '320桃園市中壢區九和一街48號3樓', 24.9615367, 121.2217157),
('統領戲院', '330桃園市桃園區中正路56號', 24.9912192, 121.3103076),
('新竹大遠百威秀影城', '300新竹市東區西大路323號', 24.8022226, 120.9625579),
('新竹巨城威秀影城', '300新竹市東區民權路176號4號樓之3', 24.8098274, 120.9718756),
('尚順威秀影城', '351苗栗縣頭份市中央路105號', 24.6890187, 120.9013559),
('台中新光影城', '407台中市西屯區臺灣大道三段301號14樓', 24.1647722, 120.6408999),
('台中大遠百威秀影城', '407台中市西屯區臺灣大道三段251號13樓', 24.1646468, 120.6420433),
('台中老虎城威秀', '407台中市西屯區河南路三段120-1號4樓', 24.1643109, 120.6355195),
('台中新時代威秀', '401台中市東區復興路四段186號4F', 24.1357775, 120.6851728),
('員林電影城', '510彰化縣員林市南昌路39號3樓', 23.9544825, 120.5705253),
('南投戲院', '540南投縣南投市大同街87號', 23.9079574, 120.6853076),
('埔里山明戲院', '545南投縣埔里鎮中山路二段289號5 樓', 23.9656183, 120.9653283),
('中華電影城', '640雲林縣斗六市雲林路二段19號', 23.7059428, 120.5330821),
('嘉年華影城', '600嘉義市西區仁愛路443號1.4樓', 23.4780407, 120.4392614),
('南台電影城', '700台南市中西區友愛街317號', 22.9922819, 120.1926311),
('台南大遠百威秀影城', '700台南市中西區公園路60號', 22.9953707, 120.2034945),
('南紡夢時代威秀影城', '701台南市東區中華東路一段366號5F', 22.9913086, 120.2307557),
('台南國賓影城', '701041台南市東區中華東路一段66號', 22.9964103, 120.2316942),
('麻豆戲院', '721台南市麻豆區興中路106號', 23.1836049, 120.2486429),
('全美戲院', '700台南市中西區永福路二段187號', 22.9939038, 120.1979599),
('今日戲院', '700台南市中西區中正路249號', 22.9926382, 120.1957034),
('高雄大遠百威秀影城', '802高雄市苓雅區三多四路21號13-15樓', 22.6130707, 120.3022379),
('高雄夢時代秀泰影城', '806高雄市前鎮區中華五路789號8樓', 22.5948268, 120.2976145),
('環球影城', '802高雄市苓雅區大順三路108號', 22.632134, 120.3227545),
('義大國賓影城', '840403高雄市大樹區學城路一段12號3F', 22.7298426, 120.4041537),
('屏東環球國賓影城', '900003屏東縣屏東市仁愛路90號環球購物中心 6樓', 22.6732716, 120.4908268),
('新月豪華影城', '260宜蘭縣宜蘭市民權路二段38巷2號3樓', 24.7541856, 121.7482416),
('花蓮秀泰影城', '970花蓮縣花蓮市國聯五路69號', 23.9910434, 121.6027492),
('台東秀泰影城', '950台東縣台東市新生路93號', 22.7518558, 121.1456223);

CREATE TABLE remaining_seats (
    showtime_id INT,
    movie_id INT, 
    cinema_id VARCHAR(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci,
    remaining_seats INT,
    PRIMARY KEY (showtime_id) -- 主鍵設置，避免重複資料
);